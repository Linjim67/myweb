/* =========================================
   1. GLOBAL LAYOUT
   ========================================= */
body {
    background: #F0ECE1;
    /* Off-white/Beige */
    color: #416361;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    margin: 0;
}

.container {
    max-width: 900px;
    margin: 40px auto;
    padding: 20px;
}


/* =========================================
   NEW: CONTROL PANEL (Top Right)
   ========================================= */
.control-panel {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 15px;
    align-items: center;
    background: white;
    padding: 10px 15px;
    border-radius: 30px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 100;
}

.control-item {
    display: flex;
    align-items: center;
    font-size: 0.9rem;
    font-weight: bold;
    color: #416361;
}

/* Switch Toggle Style */
.switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 20px;
    margin-left: 8px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 14px;
    width: 14px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked+.slider {
    background-color: #77A88D;
}

input:checked+.slider:before {
    transform: translateX(20px);
}


/* =========================================
   2. EXAM BLOCKS & HEADERS
   ========================================= */
.exam-block {
    margin-bottom: 30px;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(65, 99, 97, 0.1);
    /* Shadow using dark teal tint */
}

.block-header {
    background: #416361;
    color: #F0ECE1;
    padding: 15px 20px;
    font-size: 1.2rem;
    font-weight: bold;
}

/* =========================================
   3. PROBLEM ROW (SUMMARY VIEW)
   ========================================= */
.problem-summary {
    padding: 10px 20px;
    display: grid;
    grid-template-columns: 50px 1fr auto auto;
    gap: 15px;
    align-items: center;
    cursor: pointer;
    transition: background 0.2s;
    height: 70px;
}

.problem-row {
    border-bottom: 1px solid #BFB9B2;
    /* Greige border */
}

.problem-summary:hover {
    background-color: #678F8D !important;
}

/* Tags (Difficulty/Topic) */
.tag {
    font-size: 0.8rem;
    padding: 2px 8px;
    border-radius: 4px;
    background: #ECA594;
    /* Terracotta */
    color: white;
    margin-right: 5px;
    display: inline-block;
}

.stat-text {
    font-size: 0.85rem;
    color: #678F8D;
    /* Muted Teal */
    display: block;
    margin-top: 4px;
}

/* =========================================
   4. EXPANDED CONTENT & FIGURES
   ========================================= */
.problem-details {
    display: none;
    padding: 20px;
    background: #fafafa;
    border-top: 1px dashed #BFB9B2;
}

.question-text {
    font-size: 1.1rem;
    margin-bottom: 20px;
    font-weight: 500;
    line-height: 1.5;
    color: #333;
}

.problem-figure {
    margin: 15px 0;
    text-align: center;
}

.problem-figure img {
    max-width: 100%;
    max-height: 300px;
    border-radius: 8px;
    border: 1px solid #BFB9B2;
    cursor: zoom-in;
    transition: transform 0.2s;
    background: white;
}

.problem-figure img:hover {
    transform: scale(1.02);
}


/* =========================================
   NEW: ANIMATION (The Specific Linear Curve)
   ========================================= */
/* Default: No animation (Instant) */
.problem-details,
.option-explanation {
    display: none;
}

/* When Animation is ON, we apply a class to the container */
.animate-enabled .problem-details,
.animate-enabled .option-explanation {
    /* We use Max-Height for slide animation because 'display' cannot be animated */
    transition: all 0.6s linear(0, 0.0344, 0.0679, 0.1006, 0.1324, 0.1635, 0.1937, 0.2232, 
    0.2519, 0.2798, 0.307, 0.3334, 0.3591, 0.3841, 0.4084, 0.432, 0.4549, 0.4771, 0.4987, 
    0.5197, 0.54, 0.5597, 0.5788, 0.5973, 0.6152, 0.6325, 0.6493, 0.6655, 0.6812, 0.6963, 
    0.711, 0.7251, 0.7387, 0.7518, 0.7645, 0.7767, 0.7884, 0.7997, 0.8105, 0.821, 0.831, 
    0.8406, 0.8498, 0.8586, 0.867, 0.8751, 0.8829, 0.8902, 0.8973, 0.904, 0.9104, 0.9165, 
    0.9222, 0.9277, 0.933, 0.9379, 0.9426, 0.947, 0.9511, 0.9551, 0.9588, 0.9623, 0.9655, 
    0.9686, 0.9714, 0.9741, 0.9766, 0.9789, 0.981, 0.983, 0.9849, 0.9865, 0.9881, 0.9895, 
    0.9908, 0.992, 0.993, 0.994, 0.9949, 0.9956, 0.9963, 0.9969, 0.9974, 0.9979, 0.9983, 
    0.9986, 0.9989, 0.9992, 0.9994, 0.9995, 0.9997, 0.9998, 0.9998, 0.9999, 0.9999, 1, 1, 1, 1, 1, 1);
}



/* =========================================
   5. OPTION ITEMS
   ========================================= */
.option-item {
    padding: 12px;
    margin: 8px 0;
    border: 1px solid #BFB9B2;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
    background: white;
    /* Default */
}

.option-item:hover {
    background-color: #E8E4D9;
}

/* --- CASE 1: TP / TN (Correctly Handled) ---
   "Light Beige" (Original: #F0ECE1, Lighter: #F8F5F0) */
.opt-tp,
.opt-tn {
    background-color: #F8F5F0 !important;
    border: 1px solid #BFB9B2;
}

/* --- CASE 2: FN (False Negative - Missed Correct Answer) ---
   "Green" */
.opt-fn {
    background-color: #C5E0DC !important;
    /* Light Teal/Green BG */
    border: 2px solid #77A88D !important;
    /* Sage Green Border */
}

/* --- CASE 3: FP (False Positive - Wrong Selection) ---
   "Red" */
.opt-fp {
    background-color: #FADBD8 !important;
    /* Light Red BG */
    border: 2px solid #E17055 !important;
    /* Terracotta Border */
}

.option-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
/* Percentage Bar Styling */
.option-bar-container {
    height: 6px;
    background: #e0e0e0;
    border-radius: 3px;
    margin-top: 8px;
    overflow: hidden;
}

.option-bar-fill {
    height: 100%;
    background-color: #BFB9B2;
    transition: width 1s ease-out;
}

/* If Answer Key includes this option (TP or FN) -> GREEN */
.bar-correct .option-bar-fill {
    background-color: #77A88D;
}

/* If Answer Key EXCLUDES this option (TN or FP) -> RED */
.bar-wrong .option-bar-fill {
    background-color: #E17055;
}

.opt-tp .option-explanation,
.opt-tn .option-explanation {
    background-color: #F8F5F0;
    border-top: 1px solid #BFB9B2;
}

.opt-fn .option-explanation {
    background-color: #C5E0DC;
    border-top: 1px solid #77A88D;
}

.opt-fp .option-explanation {
    background-color: #FADBD8;
    border-top: 1px solid #E17055;
}

/* =========================================
   6. MATRIX BADGES: TRUTH TABLE STYLES
   ========================================= */

.badge-container {
    display: grid;
    grid-template-columns: repeat(6, 35px);
    gap: 5px;
    justify-items: center;
}

/* Common Badge Shape */
.option-letter-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 35px;
    height: 35px;
    border-radius: 50%;

    font-family: Arial, sans-serif;
    font-size: 16px;
    font-weight: bold;
    line-height: 1;
    padding-top: 2px;

    box-sizing: border-box;
    margin: 0;
}

/* --- CASE (1,1): TRUE POSITIVE (Correct & Chosen) --- */
.case-tp {
    background-color: #77A88D;
    /* Sage Green */
    color: white;
    border: 2px solid #416361;
    /* Dark Teal Border */
    box-shadow: 0 2px 4px rgba(65, 99, 97, 0.3);
}

/* --- CASE (1,0): FALSE POSITIVE (Wrong & Chosen) --- */
.case-fp {
    background-color: #ECA594;
    /* Terracotta */
    color: white;
    border: 2px solid #416361;
    /* Dark Teal Border */
    box-shadow: 0 2px 4px rgba(65, 99, 97, 0.3);
}

/* --- CASE (0,1): FALSE NEGATIVE (Correct & Missed) --- */
.case-fn {
    background-color: #ECA594;
    /* Terracotta */
    color: rgba(255, 255, 255, 0.5);
    border: none;
}

/* --- CASE (0,0): TRUE NEGATIVE (Wrong & Ignored) --- */
.case-tn {
    background-color: #77A88D;
    /* Sage Green */
    color: rgba(255, 255, 255, 0.5);
    border: none;
}

/* Invisible placeholder */
.badge-placeholder {
    width: 35px;
    height: 35px;
    display: inline-block;
    visibility: hidden;
}

/* =========================================
   7. SQUARE SCORE BOX
   ========================================= */

.score-box {
    position: relative;
    /* Allows corner positioning */
    width: 50px;
    height: 50px;
    border-radius: 8px;
    background: #F0ECE1;
    border: 1px solid #BFB9B2;
    color: #416361;

    /* Center the Big Number */
    display: flex;
    align-items: center;
    justify-content: center;
}

/* The Big Score (Centered) */
.score-val {
    font-size: 1.6rem;
    font-weight: bold;
    line-height: 1;
    margin-bottom: 5px;
    /* Slight lift to make room for corner text */
}

/* The Allocation (Bottom Right Corner) */
.score-alloc {
    position: absolute;
    bottom: 2px;
    right: 4px;
    font-size: 0.7rem;
    color: inherit;
    /* Inherit color from parent status */
    font-weight: normal;
    opacity: 0.8;
}

/* Color overrides */
.score-perfect {
    background: #C5E0DC;
    border: 2px solid #77A88D;
    color: #2D4A48;
}

.score-zero {
    background: #FADBD8;
    border: 2px solid #E17055;
    color: #C0392B;
}

.score-partial {
    background: #FFF3CD;
    border: 2px solid #F1C40F;
    color: #7D6608;
}


/* =========================================
   EXPLANATION TOGGLE (Fixing the Disappearance)
   ========================================= */
.option-explanation {
    display: none;
    /* Hidden by default */
    padding: 10px 15px;
    margin-top: 10px;
    background: #F0ECE1;
    color: #416361;
    font-size: 0.95rem;
    border-top: 1px solid #BFB9B2;
    border-radius: 0 0 4px 4px;
}

/* When the JavaScript adds this class, it will show */
.show-explanation .option-explanation {
    display: block;
}